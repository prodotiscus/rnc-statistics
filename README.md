# rnc-statistics

RNCStatistics -- стороннее GUI-приложение для загрузки и обработки данных из НКРЯ. Даёт возможность расширенного поиска, рандомизации, упорядочивания по большому количеству других критериев и пр.

## Добавление запроса

Для того, чтобы добавить новый напрос, нужно создать json-файл в папке `res/queries`.
Например, `res/queries/pod_dubom.json`:
```json
{
  "query_common_name": "pod_dubom",
  "query_file_name": "pod_dubom",
  "query_strings": [
    "[lex:под]{1}[lex:дуб]"
  ],
  "use_builder": "MainCorpusLexGram",
  "data_id": null,
  "query_strings_started": [],
  "number_documents": 0,
  "number_matches": 0,
  "last_pages_by_query": {},
  "query_strings_done": []
}
```

### Как заполнять поля
* Строка в поле `query_file_name` должна совпадать с именем файла, только без расширения `.json`, т.е. если Ваш файл называется `roses.are.red.json`, строка должна выглядеть как `roses.are.red`
* Для получения некоторых примеров может быть недостаточно одного запроса, и данные нужно объединить из нескольких запросов. Поэтому поле `query_strings` является списком, туда можно добавлять сколько угодно запросов. Они скачаются вместе и будут доступны в рамках одного файла.
* Поле `use_builder` определяет, из какого подкорпуса будут скачиваться данные по запросу (смотрите раздел "Подкорпусы и сборка URL")

### Подкорпусы и сборка URL
Выдача данных из НКРЯ происходит по GET-запросам, у URL этих запросов сложная структура. Поэтому есть класс `QueryBuilder` который делает всё сам, но нужно выбрать соответствующий подкорпус.
Пока что есть только один:
* `MainCorpusLexGram` -- для лексико-грамматического поиска в основном корпусе НКРЯ

### Как писать запросы
Довольно просто. В тексте запроса есть два типа элементов -- токены и расстояния. Расстояния указываются между токенами.
* Токены
  * Общая структура `[параметр1:значение][параметр2:значение][параметр3:значение][параметрN:значение]`
  * Параметры
    * `lex` -- какую лексему представляет искомый токен (`[lex:дуб]`)
    * `gr` -- грамматические признаки, разделитель -- запятая, допустима скобочная группировка и дизъюнкция (`[gr:S,(gen|gen2)]`)
    * `sem` -- семантические признаки, допустима конъюнкция, дизъюнкция и скобочная группировка (`[sem: r:concr & (pt:part | pt:partb & pc:hum)]`)
    * `add` -- дополнительные признаки (флаги), например запрет на пунктуация после токена и пр., разделитель запятая (`[add:-bmark,mw:speed:max]`)
* Расстояние
  * Если расстояние выражено одним числом -- `{n}`. Если расстояние выражается отрезком `{a, b}`. Кроме того, можно использовать `_`, как в нотации НКРЯ.
#### Пример
```
S (gen|gen2) -bmark
на расстоянии 1 от без
на расстоянии 1 от (NUM|ANUM) (gen|gen2)
```
Так отображается запрос в НКРЯ. Переведём его в наш формат:
```
[gr:S,(gen|gen2)][add:-bmark] {1} [lex:без] {1} [gr:(NUM|ANUM),(gen|gen2)]
```

Как найти `под дубом` и `под большим дубом`? `[lex:под] {1,2} [lex:дуб]`

### Сортировка скачанных данных
Раздел пока не написан.
